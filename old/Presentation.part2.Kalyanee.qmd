---
title: "Best Practices for Interpreting Omics Data with Pathway Enrichment Analysis (Part 2 edited)"
author: "Dr. Heather Kates and Kalyanee Shirlekar"
format: revealjs
editor: visual
---

### Why This Topic Matters

-   Pathway enrichment is a key step in interpreting high-throughput omics datasets

-   Commonly used in cancer research to extract biological meaning

-   **But:**

    -   Easy to misuse, especially with online tools and unclear gene lists
    -   It can be hard to know where to start with many tests and databases available

::: notes
Heather
:::

------------------------------------------------------------------------

### Roadmap

1.  What is pathway enrichment analysis (PEA)?
2.  Overview of methods: ORA, GSEA, Topology
3.  Input and background sets: what they are and why they matter
4.  Common pitfalls & 9 tips for better PEA
5.  Visualization, reproducibility, and practical tools
6.  Interpreting omics beyond transcriptomics

::: notes
Heather
:::

------------------------------------------------------------------------

### What Is Pathway Enrichment Analysis?

-   Statistical approach to identify biological pathways with associated genes that show non-random patterns in an omics dataset
-   Inputs: either a gene list or a full ranked list of features from an omics dataset
-   Outputs: enriched biological processes or pathways
-   Common in web tools: gProfiler, Enrichr, DAVID, Reactome, ExpressAnalyst etc.

::: notes
Heather
:::

------------------------------------------------------------------------

### Three Main Methods of PEA

-   **Over-representation analysis (ORA):**
    -   Uses DEGs and a background
    -   Compares observed vs expected overlap
-   **Gene Set Enrichment Analysis (GSEA):**
    -   Uses a full ranked list of genes
    -   Captures subtle, coordinated effects
-   **Topology-based analysis:**
    -   Uses gene‚Äìgene relationships in pathway networks

::: notes
Heather
:::

------------------------------------------------------------------------

### Figure: Three Methods Overview

![](images/figure1.jpg)

::: notes
Heather
:::

------------------------------------------------------------------------

### Over-representation analysis (ORA):

Examine whether any pathways are observed in a gene list of interest more than expected by chance compared with a background set

-   Uses DEGs and a background
-   Compares observed vs expected overlap
-   P-values are adjusted for multiple-testing!

<img src="images/figure1A.png" width="30%"/>

::: notes
Kalyanee. Over-representation analysis (ORA) is used to determine which a priori defined gene sets are more present (over-represented) in a subset of ‚Äúinteresting‚Äù genes than what would be expected by chance.

Suppose you have:

50 upregulated genes (your list of interest).

10,000 total expressed genes (background set).

Let's say Pathway X contains 100 genes out of the 10,000.
Of your 50 upregulated genes, 10 are part of Pathway X.

Key question: Is having 10 out of your 50 genes in Pathway X significantly more than you'd expect just by random chance, given that Pathway X is only 1% (100/10,000) of all possible genes?

ORA doesn't give you how strongly a certain pathway is presented in your list of interesting genes but rather how much disproportionate representation is there of the pathway in your list. 

ORA is not recommended in some cases:
1.What happens when you combine the up and down regulated gene lists to compare? Are your results valid?
2. How does duplicate genes in the input list and background matter? artificial over representation?
:::

------------------------------------------------------------------------

### Gene Set Enrichment Analysis (GSEA):

First rank the total gene set on the basis of detected signals, such as change of gene expression, then tests whether genes annotated to the same pathway tend to cluster together at the top (or bottom) of the ranked list.

-   Uses a full ranked list of genes
-   Captures subtle, coordinated effects
-   P-values are adjusted for multiple-testing!

<img src="images/figure1B.png" width="30%"/>

::: notes
Kalyanee. 
You rank all genes in your dataset by their level of differential expression (from most upregulated to most downregulated).

GSEA examines whether the genes from a specific pathway are concentrated at the top of this ranked list (indicating strong upregulation) or at the bottom (indicating strong downregulation).

It assigns an Enrichment Score (ES) to reflect how strongly the pathway's genes show up at the extremes of your ranking.

The ES is then normalized to account for pathway size and dataset size, producing a Normalized Enrichment Score (NES).
:::

------------------------------------------------------------------------

### Topology-based analysis:

Account for additional information that impacts pathway activity by integrating scores measuring gene positions within a pathway and gene‚Äìgene interactions into the enrichment tests.

-   Aim to increase the sensitivity of pathway enrichment analysis by considering the topological features of genes (e.g. "co-expression")
-   Requires experimental evidence for pathway structures and gene‚Äìgene interactions

<img src="images/figure1C.png" width="30%"/>

::: notes
Kalyanee. Give a brief overview
:::

------------------------------------------------------------------------

### General Workflow

-   Start with omics data (e.g., RNA-seq, proteomics, etc.)
-   Choose appropriate annotation database (e.g., GO, KEGG)
-   Select statistical method based on data type
-   Perform PEA and visualize
-   Document all assumptions and parameters

![](images/figure2.jpg)

::: notes
Kalyanee
:::

------------------------------------------------------------------------

### Classic Input: Transcriptomics

-   DEGs from bulk RNA-seq or microarrays
-   Common methods: ORA (Fisher), GSEA, TPEA
-   Caution: arbitrary DEG thresholds may distort findings
-   GSEA uses full data, reducing cutoff bias

::: notes
Kalyanee
:::

------------------------------------------------------------------------

### The Importance of Input and Background Sets

-   **Input set:** filtered list of genes, proteins, or metabolites
-   **Background set:** all features detected in the experiment
-   ‚ùó Using all genes in the genome as background = common mistake

::: notes
Kalyanee
:::

------------------------------------------------------------------------

### Example: Why Background Matters

-   RNA-seq study using genome-wide vs. expressed-gene background
-   Only 44% overlap in enriched pathways
-   Use actual detected features as background!

<img src="images/F1.large.jpg" width="39%"/>

::: notes
Kalyanee
:::

------------------------------------------------------------------------

### Reference Annotation Databases

-   KEGG, Reactome, GO, MetaCyc, EcoCyc, etc.
-   Pathway size and definitions vary between databases
-   Use the most updated versions
-   Report: database, version, date

::: notes
Kalyanee
:::

------------------------------------------------------------------------

**Web Tool Summary Table**

:::: {style="max-height: 600px; overflow-y: auto;"}
::: {style="font-size: 65%; line-height: 1.1;"}
| Tool | ORA | GSEA | Topology | GO | KEGG | Reactome | MSigDB | Other Databases |
|--------|:------:|:------:|:------:|:------:|:------:|:------:|:------:|--------|
| g:Profiler | ‚úÖ | üî∂ |  | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | TRANSFAC, miRTarBase, WikiPathways |
| Enrichr | ‚úÖ |  |  | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ChEA, DrugMatrix, TF/miRNA |
| DAVID | ‚úÖ |  |  | ‚úÖ | ‚úÖ | ‚úÖ |  | Panther, BioCarta |
| WebGestalt | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | WikiPathways, user-defined sets |
| Reactome | ‚úÖ | ‚úÖ |  |  |  | ‚úÖ |  |  |
| PantherDB | ‚úÖ | ‚úÖ |  | ‚úÖ |  |  |  | Panther Pathways |
| Metascape | ‚úÖ |  |  | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | CORUM, WikiPathways |
| ShinyGO | ‚úÖ |  |  | ‚úÖ | ‚úÖ |  | üî∏ | Limited subset of MSigDB |
| PathDIP | ‚úÖ |  | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |  | PID, BioCarta, PPI-aware pathways |
| GSEA-MSigDB |  | ‚úÖ |  | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | Hallmark, C1‚ÄìC7 collections |
| ExpressAnalyst | ‚úÖ | ‚úÖ |  | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | BioCarta, WikiPathways |
| Cytoscape EnrichMap |  | ‚úÖ |  | Any | Any | Any | Any | Visualization |
:::
::::

::: notes
Kalyanee
:::

------------------------------------------------------------------------

### 9 Quick Tips to Avoid PEA Pitfalls

1.  Know what analysis type fits your data
2.  Clean, validated input gene list only
3.  Use \>1 PEA tool, compare results
4.  Document all tool versions & parameters
5.  Always use adjusted p-values
6.  Choose statistical tests & visualizations wisely
7.  Consider analyzing gene subgroups/networks
8.  Validate with recent literature
9.  Review with a wet-lab biologist or clinician

::: notes
Heather
:::

------------------------------------------------------------------------

### Common Errors in Published PEA Studies

-   90% of surveyed studies used incorrect background sets
-   16 of 25 popular tools used outdated databases
-   Up to 40% more false positives without multiple testing correction

::: notes
Heather
:::

------------------------------------------------------------------------

### Visualizing Your Results

-   Visualization improves interpretation
-   Tools:
    -   enrichplot (R)
    -   Enrichment Map (Cytoscape)
    -   REVIGO
    -   CirGO
-   Use clustering or similarity to group redundant terms

::: notes
Heather\
Clustering terms can reduce redundancy\
REVIGO is great for summarizing GO terms.\
Enrichment Map is ideal for interactive exploration of results.
:::

------------------------------------------------------------------------

### Reporting is Key

-   The result of pathway enrichment depends on the data, assumptions, and tools you use.
-   Therefore, these **must** be reported in your presentations and publications:
    -   Gene list origin and filtering criteria
    -   Background set definition
    -   Tool name, version, database, and date
    -   Statistical method, FDR threshold

::: notes
Heather
:::

------------------------------------------------------------------------

### Special Case: scRNA-seq

-   Sparse data, many zeros
-   Tools like iDEA use Bayesian models to improve detection
-   Enables pathway analysis at single-cell resolution

::: notes
Heather
:::

------------------------------------------------------------------------

### Special Case: Epigenomics

-   Gene length and CpG mapping introduce bias
-   Tools: ebGSEA, GOmeth
-   GOmeth accounts for multigene mapping and gene size

::: notes
Heather
:::

------------------------------------------------------------------------

### Integrated Omics

-   Combines transcriptomics, proteomics, GWAS, etc.
-   Tool: ActivePathways (combines p-values from each omics layer)
-   Pros: improves power
-   Cons: complex, needs careful integration

::: notes
Heather
:::

------------------------------------------------------------------------

### Final Thoughts

-   Pathway enrichment is powerful if done right
-   Many omics types require special considerations
-   Don't rely on defaults or black-box tools
-   Collaboration between biologists and bioinformaticians is key

::: notes
Heather
:::

------------------------------------------------------------------------

### Open Questions

-   What are the best ways to integrate multiple data layers?
-   What makes a good PEA tool for non-programmers?

::: notes
Heather
:::

------------------------------------------------------------------------
